# Hookchain

## Abstract - EN

In the current digital security ecosystem, where threats evolve rapidly and with complexity, companies developing Endpoint Detection and Response (EDR) solutions are in constant search for innovations that not only keep up but also anticipate emerging attack vectors.

In this context, this article introduces the HookChain, a look from another perspective at widely known techniques, which when combined, provide an additional layer of sophisticated evasion against traditional EDR systems.

Through a precise combination of IAT Hooking techniques, dynamic SSN resolution, and indirect system calls, HookChain redirects the execution flow of Windows subsystems in a way that remains invisible to the vigilant eyes of EDRs that only act on Ntdll.dll, without requiring changes to the source code of the applications and malwares involved.

This work not only challenges current conventions in cybersecurity but also sheds light on a promising path for future protection strategies, leveraging the understanding that continuous evolution is key to the effectiveness of digital security. 

By developing and exploring the HookChain  technique, this study significantly contributes to the body of knowledge in endpoint security, stimulating the development of more robust and adaptive solutions that can effectively address the ever-changing dynamics of digital threats. This work aspires to inspire deep reflection and advancement in the research and development of security technologies that are always several steps ahead of adversaries.

## Abstract - PT-BR

No atual ecossistema de segurança digital, onde ameaças evoluem com rapidez e complexidade, as empresas desenvolvedoras de soluções de detecção e resposta em endpoints (EDR) estão em constante busca por inovações que não apenas acompanhem, mas antecipem os vetores de ataque emergentes. Nesse contexto, este artigo introduz o HookChain, um olhar sob outro ponto de vista de técnicas amplamente conhecidas, porém quando combinadas proporciona uma camada adicional de evasão sofisticada frente aos tradicionais sistemas EDR. 

Através de uma combinação precisa de técnicas de IAT Hooking, resolução dinâmica de SSNs e chamadas de sistema indiretas, o HookChain redireciona o fluxo de execução dos subsistemas do Windows de maneira que permanece invisível aos olhares vigilantes dos EDRs que atuam somente na Ntdll.dll, sem necessitar de alterações no código-fonte das aplicações e malwares envolvidos. 

Este trabalho não apenas desafia as convenções atuais em segurança cibernética, mas também ilumina um caminho promissor para futuras estratégias de proteção, alavancando a compreensão de que a evolução contínua é fundamental para a eficácia da segurança digital. 

Ao desenvolver e explorar a técnica HookChain, este estudo contribui significativamente para o corpo de conhecimento em segurança de endpoints, estimulando o desenvolvimento de soluções mais robustas e adaptativas que possam efetivamente enfrentar a dinâmica sempre em transformação das ameaças digitais. Este trabalho aspira a inspirar uma reflexão profunda e o avanço na pesquisa e desenvolvimento de tecnologias de segurança que estejam sempre vários passos à frente dos adversários.

## ACM Reference Format

```
Helvio Carvalho Junior. 2024. HookChain: A new perspective for Bypassing EDR Solutions. Curitiba, PR, BRAZIL. https://arxiv.org/abs/2404.16856
```

## HookChain Talks

- [Sector/BlackHat Toronto](https://youtu.be/Rxw0DFkMeQ8)
- [DEFCON 32](https://youtu.be/AfDXAdLJ7dU?si=Q5BTLWIfeSRUwaK3)
- [MindTheSec 2024](https://www.youtube.com/watch?v=EM5xejYhl1s)

## White paper

- [English v1.5](https://github.com/helviojunior/hookchain/blob/main/HookChain_en_v1.5.pdf)
- [Portugues v1.5](https://github.com/helviojunior/hookchain/blob/main/HookChain_pt_v1.5.pdf)

## Contact

- LinkedIn contact: [https://www.linkedin.com/in/helviojunior/](https://www.linkedin.com/in/helviojunior/)
- Telegram contact: [https://t.me/helviojunior](https://t.me/helviojunior)

## My public releases regarding HookChain:

- [Cylance bypass](https://www.linkedin.com/posts/helviojunior_hookchain-edrbypass-lsassdump-activity-7212439618598686720-mfNm?utm_source=share&utm_medium=member_desktop)
- [SentinelOne bypass](https://www.linkedin.com/posts/helviojunior_hookchain-edrbypass-lsassdump-activity-7208853059592982530-0Ufa?utm_source=share&utm_medium=member_desktop)
- [CrowdStrike bypass](https://www.linkedin.com/posts/helviojunior_hookchain-havoc-edr-activity-7181441094356783104-nyk_?utm_source=share&utm_medium=member_desktop)
- [CrowdStrike bypass - again](https://www.linkedin.com/posts/helviojunior_hookchain-edrbypass-lsassdump-activity-7188911783510724609-iaoV?utm_source=share&utm_medium=member_desktop)
- [Trend Apex One bypass](https://www.linkedin.com/posts/helviojunior_hookchain-havoc-edr-activity-7183817134488051713-J3d-?utm_source=share&utm_medium=member_desktop)
- [BitDefender bypass](https://www.linkedin.com/posts/helviojunior_bypass-bypassedr-hookchain-activity-7179578975701123072-tISP?utm_source=share&utm_medium=member_desktop)
- [Call for EDR/XDR product with zero answers](https://www.linkedin.com/posts/helviojunior_hookchain-edrbypass-xdrbypass-activity-7188225698434596865-3Jxy?utm_source=share&utm_medium=member_desktop)
